<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AngkatAni - Homepage</title>
    <link rel="stylesheet" type="text/css" href="../static/css/seller_orders.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/homepage_buyer.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>


<!-- Header -->
<header class="top-bar">
  <div class="logo">
      <img src="static/images/logo.png" alt="AngkatAni Logo" class="logo-icon">
      AngkatAni
  </div>          
  <div class="tagline">Connecting you to Local Farmers</div>
</header>


<!-- Navigation Menu -->
<nav class="nav-menu">
  <ul>
    <li><a href="/homepage_seller">Home</a></li>
    <li><a href="#contacts">Contacts</a></li>
  </ul>
</nav>


<!-- Breadcrumb Navigation -->
<nav class="main-nav">
  <ul class="breadcrumb">
    <li><a href="/homepage_seller"> <i class="fas fa-home"></i></a></li>
    <li>â€º</li>
    <li><a href="/homepage_seller" class="button">Order Status</a></li>
  </ul>
  <div class="icons">
    <div class="user-dropdown" id="userDropdown">
      <span class="user" id="userIcon"><i class="fas fa-user"></i></span>
      <div class="user-menu" id="userMenu">
        <form action="{{ url_for('homepage_seller.logout') }}" method="post">
          <button class="logout-btn" type="submit">Logout</button>
        </form>
      </div>
    </div>
  </div>
</nav>


<div class="container">
  <aside class="sidebar">
    <div class="status">
      <h3>SELLER MENU</h3>
      <ul class="status-list">
        <li>
          <form action="/homepage_seller" method="get">
            <button type="submit" class="status-item"><i class="fas fa-home"></i> Homepage</button>
          </form>
        </li>
        <li>
          <form action="{{ url_for('seller_orders.unpaid_orders') }}" method="get">
            <button type="submit" class="status-item"><i class="fas fa-receipt"></i> Orders</button>
          </form>
        </li>
        <li>
          <button type="button" class="status-item" id="addProductBtn">
              <i class="fas fa-plus-circle"></i> Add Product
          </button>
        </li>
        <li>
        <form action="/dashboard" method="get">
          <button type="submit" class="status-item">
            <i class="fas fa-tachometer-alt"></i> Dashboard
          </button>
        </form>
      </li>
      </ul>
    </div>
  </aside>


  <div class="column-right">
    <div class="status-container">
        <h3>STATUS</h3>
        <div class="status-tracker">
          <form action="{{ url_for('seller_orders.unpaid_orders') }}" method="get" class="step">
            <button type="submit" class="circle {% if order_type == 'unpaid' %}active-status{% endif %}">
              <i class="fas fa-wallet"></i>
            </button>
            <p>Unpaid</p>
          </form>
     
          <form action="{{ url_for('seller_orders.to_ship_orders') }}" method="get" class="step">
            <button type="submit" class="circle {% if order_type == 'to_ship' %}active-status{% endif %}">
              <i class="fas fa-box"></i>
            </button>
            <p><strong>To Ship</strong></p>
          </form>
     
          <form action="{{ url_for('seller_orders.shipping_orders') }}" method="get" class="step">
            <button type="submit" class="circle {% if order_type == 'shipping' %}active-status{% endif %}">
              <i class="fas fa-truck"></i>
            </button>
            <p>Shipping</p>
          </form>
     
          <form action="{{ url_for('seller_orders.delivered_orders') }}" method="get" class="step">
            <button type="submit" class="circle {% if order_type == 'delivered' %}active-status{% endif %}">
              <i class="fas fa-check-circle"></i>
            </button>
            <p>Completed</p>
          </form>
     
          <form action="{{ url_for('seller_orders.cancelled_orders') }}" method="get" class="step">
            <button type="submit" class="circle {% if order_type == 'cancelled' %}active-status{% endif %}">
              <i class="fas fa-times-circle"></i>
            </button>
            <p>Cancelled</p>
          </form>
        </div>      
      </div>
 


      <div class="product-info">
        <h1>ORDER DETAILS</h1>
        <form method="get"  class="sort-form">
                <label for="sort">Sort by:</label>
                  <select name="sort" id="sort" onchange="this.form.submit()">
                    <option value="recent" {% if request.args.get('sort') == 'recent' %}selected{% endif %}>Recent</option>
                    <option value="old" {% if request.args.get('sort') == 'old' %}selected{% endif %}>Old</option>
                  </select>
                </form>
        {% if order_details %}
          <table class="variation-table">
            <thead>
              <tr>
                <th>Image</th>
                <th>Product</th>
                <th>Qty</th>
                <th>Variation</th>
                <th>Price</th>
                <th>Shipping Fee</th>
                <th>Buyer Address</th>
                <th>Payment Method</th>
                <th>Total</th>
                <th>Status</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              {% for order_detail in order_details %}
              <tr>
                <td>
                  <img src="{{ url_for('static', filename='images/products/' + order_detail['ImageFileName']) }}" alt="{{ order_detail['Product_Name'] }}" class="order-thumb">
                </td>
                <td>{{ order_detail['Product_Name'] }}</td>
                <td>x{{ order_detail['Quantity'] }}</td>
                <td>{{ order_detail['Unit'] }}</td>
                <td>P{{ order_detail['Price'] }}</td>
                <td>P{{ order_detail['Shipping_Fee'] }}</td>
                <td>{{ order_detail['Buyer_Address'] }}</td>
                <td>{{ order_detail['Payment_Option'] }}</td>
                <td>P{{ order_detail['Total_Amount'] }}</td>
                <td>
                  {% if order_type == 'unpaid' %}
                    <span class="status unpaid">Unpaid</span>
                  {% elif order_type == 'to_ship' %}
                    <span class="status to-ship">To Ship</span>
                  {% elif order_type == 'shipping' %}
                    <span class="status shipping">Shipping</span>
                  {% elif order_type == 'delivered' %}
                    <span class="status completed">Completed</span>
                  {% elif order_type == 'cancelled' %}
                    <span class="status cancelled">Cancelled</span>
                  {% endif %}
                </td>
                <td>
                  {% if order_type == 'unpaid' %}
                    <form action="{{ url_for('seller_orders.cancel_unpaid_order', order_id=order_detail['OrderID']) }}" method="post">
                      <button type="submit" class="button1">Cancel</button>
                    </form>
                  {% elif order_type == 'to_ship' %}
                    <form action="{{ url_for('seller_orders.ship_now', order_id=order_detail['OrderID']) }}" method="post">
                      <button type="submit" class="button1">Ship</button>
                    </form>
                    <form action="{{ url_for('seller_orders.cancel_to_ship_order', order_id=order_detail['OrderID']) }}" method="post">
                      <button type="submit" class="button1 delete-btn">Cancel</button>
                    </form>
                  {% endif %}
                </td>
              </tr>
              <tr>
                    <td colspan="10" id="var-date"><b>Order Date & Time: </b>{{ order_detail['Order_Date'] }}</td>
                  </tr>
              {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p class="no-orders-msg">No orders yet! Place an order now!</p>
        {% endif %}
      </div>
  </div>    
</div>
<!-- Newsletter -->
<section id ="contacts" class="newsletter">
  <div class="newsletter-content">
    <div class="newsletter-text">
      <h3><i class="fas fa-envelope"></i> Subscribe to our Newsletter</h3>
      <p>Stay connected with the latest updates and local farm offers.</p>
    </div>
    <form class="newsletter-form">
      <input type="email" placeholder="Your email address" required />
      <button type="submit">Subscribe</button>
    </form>
    <div class="social-icons">
      <a href="#"><i class="fab fa-facebook-f"></i></a>
      <a href="#"><i class="fab fa-twitter"></i></a>
      <a href="#"><i class="fab fa-instagram"></i></a>
    </div>
  </div>
</section>


<!-- Footer -->
<footer class="main-footer">
  <div class="footer-content">
    <div class="footer-about">
      <img src="static/images/logo.png" alt="AngkatAni Logo" class="logo-icon">
      AngkatAni
      <p>Empowering farmers and connecting communities through sustainable commerce.</p>
      <p><strong>09271674524</strong><br />angkatani@.com</p>
    </div>
    <div class="footer-columns">
      <div>
        <h5>My Account</h5>
        <ul>
          <li>My Account</li>
          <li>Order History</li>
          <li>Shopping Cart</li>
          <li>Wishlist</li>
        </ul>
      </div>
      <div>
        <h5>Help</h5>
        <ul>
          <li>Contact</li>
          <li>FAQs</li>
          <li>Terms & Conditions</li>
          <li>Privacy Policy</li>
        </ul>
      </div>
      <div>
        <h5>Proxy</h5>
        <ul>
          <li>About</li>
          <li>Shop</li>
          <li>Product</li>
          <li>Track Order</li>
        </ul>
      </div>
      <div>
        <h5>Categories</h5>
        <ul>
          <li>Order History</li>
          <li>Shopping Cart</li>
          <li>Wishlist</li>
        </ul>
      </div>
    </div>
  </div>
</footer>


<!-- Scripts -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const userIcon = document.getElementById('userIcon');
    const userMenu = document.getElementById('userMenu');


    userIcon.addEventListener('click', function (event) {
      userMenu.classList.toggle('show');
      event.stopPropagation();
    });


    document.addEventListener('click', function (event) {
      if (!userMenu.contains(event.target)) {
        userMenu.classList.remove('show');
      }
    });


    const refreshPageValue = "{{ refresh_page }}";
    if (refreshPageValue === 'True' && !sessionStorage.hasReloaded) {
      window.location.reload();
      sessionStorage.hasReloaded = true;
    } else {
      sessionStorage.removeItem('hasReloaded');
    }
  });

  
            document.getElementById("addProductBtn").addEventListener("click", function () {
    fetch("/check_payment_options")
        .then(response => response.json())
        .then(data => {
            if (data.hasPayment) {
                window.location.href = "/add_product";
            } else {
                Swal.fire({
                    icon: 'warning',
                    title: 'Set Payment Options First',
                    text: 'Before adding a product, please set your payment options.',
                    confirmButtonText: 'Go to Payment Options'
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = "/payment_options"; 
                    }
                });
            }
        });
});

      document.getElementById("addProductBtn").addEventListener("click", function () {
    fetch("/check_payment_options")
        .then(response => response.json())
        .then(data => {
            if (data.hasPayment) {
                window.location.href = "/add_product";
            } else {
                Swal.fire({
                    icon: 'warning',
                    title: 'Set Payment Options First',
                    text: 'Before adding a product, please set your payment options.',
                    confirmButtonText: 'Go to Payment Options'
                }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = "/payment_options"; 
                    }
                });
            }
        });
});
</script>


</body>
</html>



